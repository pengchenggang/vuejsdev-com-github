import{_ as s,o as n,c as a,V as l}from"./chunks/framework.89791141.js";const D=JSON.parse('{"title":"更新日志","description":"","frontmatter":{},"headers":[],"relativePath":"log/log.md","filePath":"log/log.md","lastUpdated":1683856978000}'),p={name:"log/log.md"},o=l(`<h1 id="更新日志" tabindex="-1">更新日志 <a class="header-anchor" href="#更新日志" aria-label="Permalink to &quot;更新日志&quot;">​</a></h1><details class="details custom-block"><summary>目录</summary><nav class="table-of-contents"><ul><li><a href="#log-1-安装了宝塔">Log. 1: 安装了宝塔</a></li><li><a href="#log-2-markdown-语法">Log. 2: Markdown 语法</a></li><li><a href="#log-3-站点环境">Log. 3: 站点环境</a></li><li><a href="#log-4-服务器环境">Log. 4: 服务器环境</a></li><li><a href="#log-5-服务器站点搭建">Log. 5: 服务器站点搭建</a></li><li><a href="#log-6-前端网站发布工作流">Log. 6: 前端网站发布工作流</a></li></ul></nav></details><p>日常更新维护日志和站点服务搭建都放在这里面</p><table><thead><tr><th>调试</th><th>发布</th></tr></thead><tbody><tr><td><a href="http://localhost:8086/log/log.html" target="_blank" rel="noreferrer">本机开发地址</a></td><td><a href="https://www.vuejsdev.com/log/log.html" target="_blank" rel="noreferrer">在线发布地址</a></td></tr></tbody></table><h2 id="log-1-安装了宝塔" tabindex="-1">Log. 1: 安装了宝塔 <a class="header-anchor" href="#log-1-安装了宝塔" aria-label="Permalink to &quot;Log. 1: 安装了宝塔&quot;">​</a></h2><p><code>2022年9月8日</code></p><blockquote><p>之前服务器上 装了nginx mysql等等，今天看抖音，感觉安装个宝塔试试。</p></blockquote><ul><li>由于之前装过mysql什么的，宝塔再装一遍就重复了</li><li>这个装好后开的13890端口，服务器防护墙规则要添加这个端口</li><li>宝塔官网 <a href="https://www.bt.cn/" target="_blank" rel="noreferrer">https://www.bt.cn/</a></li><li>需要在官网注册手机号，绑定安装的系统</li></ul><h2 id="log-2-markdown-语法" tabindex="-1">Log. 2: Markdown 语法 <a class="header-anchor" href="#log-2-markdown-语法" aria-label="Permalink to &quot;Log. 2: Markdown 语法&quot;">​</a></h2><p><a href="https://vitepress.vuejs.org/guide/markdown" target="_blank" rel="noreferrer">https://vitepress.vuejs.org/guide/markdown</a></p><h2 id="log-3-站点环境" tabindex="-1">Log. 3: 站点环境 <a class="header-anchor" href="#log-3-站点环境" aria-label="Permalink to &quot;Log. 3: 站点环境&quot;">​</a></h2><p>当前站点域名服务器购买地址</p><ul><li>域名在<code>华为云</code>购买 <a href="https://www.huaweicloud.com/" target="_blank" rel="noreferrer">https://www.huaweicloud.com/</a><ul><li>到期时间 2023-07-21</li><li>华为云域名续费相对贵一些，3 个月后可以转到 ucloud</li></ul></li><li>服务器在<code>ucloud</code>购买 <a href="https://console.ucloud.cn/" target="_blank" rel="noreferrer">https://console.ucloud.cn/</a><ul><li>到期时间 2025-07-14</li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">坑中回忆 - 空间域名备案</p><p>最先买了个域名，觉得哪里买都 ok，就在个大品牌买就 ok 了，阿里、华为、腾讯，肯定牛气呗，最后在华为买了个域名。</p><p>然后看了下服务器，本着哪个便宜来哪个的原则，就上的 ucloud 服务器。</p><p>备案的时候就蒙了，因为开始以为在华为备案，一通认证，最后发现服务器在哪里就在哪里备案。</p><p>以后再购买的时候，服务器和域名一定要在一个地方买省得麻烦，还得来回切换。</p></div><h2 id="log-4-服务器环境" tabindex="-1">Log. 4: 服务器环境 <a class="header-anchor" href="#log-4-服务器环境" aria-label="Permalink to &quot;Log. 4: 服务器环境&quot;">​</a></h2><p>服务器环境及搭建已经装了哪些软件，站点是如何发布的，开发工作流等等。</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">镜像: CentOS 8.3 64位</span></span>
<span class="line"><span style="color:#A6ACCD;">CPU: 1核</span></span>
<span class="line"><span style="color:#A6ACCD;">内存: 2G</span></span>
<span class="line"><span style="color:#A6ACCD;">系统盘总容量: 40GB</span></span>
<span class="line"><span style="color:#A6ACCD;">数据盘总容量: 0GB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">坑中回忆 - CentOS 版本问题</p><p>创建服务器的时候 我选择了最新版的 CentOS 8，无知的少年就此开始了悲催的旅程</p><p>后来发现主流的操作系统是 CentOS 7，网上解决 bug 的方案基本都是 7 的。</p><p>主要区别就是 目录结构等等不一样，会造成解决一个问题会很繁琐，本来一个前端搞这个就不是很熟，自己还搞这种为难自己的事情。</p></div><h2 id="log-5-服务器站点搭建" tabindex="-1">Log. 5: 服务器站点搭建 <a class="header-anchor" href="#log-5-服务器站点搭建" aria-label="Permalink to &quot;Log. 5: 服务器站点搭建&quot;">​</a></h2><p>主要是利用 Nginx 代理转发，用 pm2 持续开启进程。http-server 开启 8080 服务，然后 Nginx 映射到根目录，这里主要为了后期 nestjs 开服务，映射 api 目录。</p><ul><li>Nginx 开启后台进程会一直在</li><li>http-server 服务要用 pm2 进行进程持续开启</li></ul><div class="tip custom-block"><p class="custom-block-title">坑中回忆 - Nginx 安装及 https 协议</p><p>Nginx 安装比较简单，拉一个包安装到指定位置就好了。关键是 https 协议，要先申请证书，然后配置在 Nginx 中，还要从新编译 Nginx，这个时候要回到 Nginx 的安装包，这一通找啊~</p></div><ul><li>本机连服务器 <code>MobaXterm1_CHS1</code></li><li>显示当前目录 <code>pwd</code></li><li>nginx 安装包软件目录 编译时候用 <code>/nginx/nginx-1.18.0/</code></li><li>nginx 配置文件 <code>/usr/local/nginx/conf/nginx.conf</code></li><li>nginx 启动 <code>nginx -t &amp;&amp; nginx -s reload</code></li><li>nginx 停止 <code>nginx -s stop</code></li><li>nginx 做软连接 <code>ln -s /usr/local/nginx/sbin/nginx /usr/local/sbin</code></li><li>启动前端 <code>cd /root/vuejsdev-com/docs/.vitepress/dist &amp;&amp; pm2 start http-server --name vuejsdevFE-8080 -- -p 8080</code></li><li>启动前端调试 <code>cd /root/vuejsdev-com &amp;&amp; pm2 start npm --name npm8080VuejsdevFE -- run dev8080</code></li><li>启动后端 <code>cd /root/gateway-study &amp;&amp; pm2 start dist/src/main.js</code></li><li>pm2 删除进程 <code>pm2 delete all</code></li><li>pm2 重启进程 <code>pm2 restart vuejsdev-com</code></li><li>查看当前 tomcat 是否启动 <code>ps -ef|grep tomcat</code></li><li>查看当前 node 是否启动 <code>ps -ef|grep node</code></li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">www       756970  756959  0 14:14 ?        00:00:00 node /root/vuejsdev-com/node_modules/.bin/vitepress serve docs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>删除进程 <code>kill -9 756970</code> <code>kill -9 pid</code></li></ul><div class="info custom-block"><p class="custom-block-title">git pull 不用每次输入账号密码</p><p>git config --global credential.helper store</p><p>给脚本赋值权限 <code>chomd 777 nest.sh</code></p></div><p><strong>不常用命令</strong></p><ul><li>查看硬盘空间 <code>df -h</code></li><li>查看 cpu 内存 <code>top</code></li></ul><h2 id="log-6-前端网站发布工作流" tabindex="-1">Log. 6: 前端网站发布工作流 <a class="header-anchor" href="#log-6-前端网站发布工作流" aria-label="Permalink to &quot;Log. 6: 前端网站发布工作流&quot;">​</a></h2><p>利用 nodejs 脚本一键发布，在 package.json 的 script 里面执行脚本 <code>&quot;打包并发布&quot;: &quot;node script-ci/giteeUpdate.js&quot;,</code></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// giteeUpdate.js</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> exec </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">child_process</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">exec</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> async </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">async</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">async</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">series</span><span style="color:#A6ACCD;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vitepress build docs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1. 打包完成！</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">git add .</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">git push</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">git commit -m buildFastByGiteeUpdate</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">git push -u origin master</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2. git push完成！</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ssh root@117.50.187.55 &#39;/root/vuejsdev.sh&#39;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">())</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">打包发布网站完成！</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>服务器端的脚本相对简单一些，pull 一下就可以了</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/root/vuejsdev-com</span></span>
<span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pull</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#npm run build</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#pm2 delete nest</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#pm2 start node --name nest -- dist/src/main</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devjsdev-com gitee is ok</span><span style="color:#89DDFF;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>配置好脚本，每次自动打包，上传到 gitee，然后服务器拉取一下就 ok 了。</p>`,34),e=[o];function t(c,r,i,y,F,d){return n(),a("div",null,e)}const A=s(p,[["render",t]]);export{D as __pageData,A as default};
